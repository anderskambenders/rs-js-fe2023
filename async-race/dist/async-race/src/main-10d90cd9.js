(()=>{"use strict";var e={837:(e,n,t)=>{t.d(n,{Z:()=>s});var a=t(81),r=t.n(a),i=t(645),o=t.n(i)()(r());o.push([e.id,'/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */\n\n/* Document\n   ========================================================================== */\n\n/**\n * 1. Correct the line height in all browsers.\n * 2. Prevent adjustments of font size after orientation changes in iOS.\n */\n\nhtml {\n  line-height: 1.15; /* 1 */\n  -webkit-text-size-adjust: 100%; /* 2 */\n}\n\n/* Sections\n   ========================================================================== */\n\n/**\n * Remove the margin in all browsers.\n */\n\nbody {\n  margin: 0;\n}\n\n/**\n * Render the `main` element consistently in IE.\n */\n\nmain {\n  display: block;\n}\n\n/**\n * Correct the font size and margin on `h1` elements within `section` and\n * `article` contexts in Chrome, Firefox, and Safari.\n */\n\nh1 {\n  font-size: 2em;\n  margin: 0.67em 0;\n}\n\n/* Grouping content\n   ========================================================================== */\n\n/**\n * 1. Add the correct box sizing in Firefox.\n * 2. Show the overflow in Edge and IE.\n */\n\nhr {\n  box-sizing: content-box; /* 1 */\n  height: 0; /* 1 */\n  overflow: visible; /* 2 */\n}\n\n/**\n * 1. Correct the inheritance and scaling of font size in all browsers.\n * 2. Correct the odd `em` font sizing in all browsers.\n */\n\npre {\n  font-family: monospace, monospace; /* 1 */\n  font-size: 1em; /* 2 */\n}\n\n/* Text-level semantics\n   ========================================================================== */\n\n/**\n * Remove the gray background on active links in IE 10.\n */\n\na {\n  background-color: transparent;\n}\n\n/**\n * 1. Remove the bottom border in Chrome 57-\n * 2. Add the correct text decoration in Chrome, Edge, IE, Opera, and Safari.\n */\n\nabbr[title] {\n  border-bottom: none; /* 1 */\n  text-decoration: underline; /* 2 */\n  text-decoration: underline dotted; /* 2 */\n}\n\n/**\n * Add the correct font weight in Chrome, Edge, and Safari.\n */\n\nb,\nstrong {\n  font-weight: bolder;\n}\n\n/**\n * 1. Correct the inheritance and scaling of font size in all browsers.\n * 2. Correct the odd `em` font sizing in all browsers.\n */\n\ncode,\nkbd,\nsamp {\n  font-family: monospace, monospace; /* 1 */\n  font-size: 1em; /* 2 */\n}\n\n/**\n * Add the correct font size in all browsers.\n */\n\nsmall {\n  font-size: 80%;\n}\n\n/**\n * Prevent `sub` and `sup` elements from affecting the line height in\n * all browsers.\n */\n\nsub,\nsup {\n  font-size: 75%;\n  line-height: 0;\n  position: relative;\n  vertical-align: baseline;\n}\n\nsub {\n  bottom: -0.25em;\n}\n\nsup {\n  top: -0.5em;\n}\n\n/* Embedded content\n   ========================================================================== */\n\n/**\n * Remove the border on images inside links in IE 10.\n */\n\nimg {\n  border-style: none;\n}\n\n/* Forms\n   ========================================================================== */\n\n/**\n * 1. Change the font styles in all browsers.\n * 2. Remove the margin in Firefox and Safari.\n */\n\nbutton,\ninput,\noptgroup,\nselect,\ntextarea {\n  font-family: inherit; /* 1 */\n  font-size: 100%; /* 1 */\n  line-height: 1.15; /* 1 */\n  margin: 0; /* 2 */\n}\n\n/**\n * Show the overflow in IE.\n * 1. Show the overflow in Edge.\n */\n\nbutton,\ninput { /* 1 */\n  overflow: visible;\n}\n\n/**\n * Remove the inheritance of text transform in Edge, Firefox, and IE.\n * 1. Remove the inheritance of text transform in Firefox.\n */\n\nbutton,\nselect { /* 1 */\n  text-transform: none;\n}\n\n/**\n * Correct the inability to style clickable types in iOS and Safari.\n */\n\nbutton,\n[type="button"],\n[type="reset"],\n[type="submit"] {\n  appearance: button;\n  -webkit-appearance: button;\n}\n\n/**\n * Remove the inner border and padding in Firefox.\n */\n\nbutton::-moz-focus-inner,\n[type="button"]::-moz-focus-inner,\n[type="reset"]::-moz-focus-inner,\n[type="submit"]::-moz-focus-inner {\n  border-style: none;\n  padding: 0;\n}\n\n/**\n * Restore the focus styles unset by the previous rule.\n */\n\nbutton:-moz-focusring,\n[type="button"]:-moz-focusring,\n[type="reset"]:-moz-focusring,\n[type="submit"]:-moz-focusring {\n  outline: 1px dotted ButtonText;\n}\n\n/**\n * Correct the padding in Firefox.\n */\n\nfieldset {\n  padding: 0.35em 0.75em 0.625em;\n}\n\n/**\n * 1. Correct the text wrapping in Edge and IE.\n * 2. Correct the color inheritance from `fieldset` elements in IE.\n * 3. Remove the padding so developers are not caught out when they zero out\n *    `fieldset` elements in all browsers.\n */\n\nlegend {\n  box-sizing: border-box; /* 1 */\n  color: inherit; /* 2 */\n  display: table; /* 1 */\n  max-width: 100%; /* 1 */\n  padding: 0; /* 3 */\n  white-space: normal; /* 1 */\n}\n\n/**\n * Add the correct vertical alignment in Chrome, Firefox, and Opera.\n */\n\nprogress {\n  vertical-align: baseline;\n}\n\n/**\n * Remove the default vertical scrollbar in IE 10+.\n */\n\ntextarea {\n  overflow: auto;\n}\n\n/**\n * 1. Add the correct box sizing in IE 10.\n * 2. Remove the padding in IE 10.\n */\n\n[type="checkbox"],\n[type="radio"] {\n  box-sizing: border-box; /* 1 */\n  padding: 0; /* 2 */\n}\n\n/**\n * Correct the cursor style of increment and decrement buttons in Chrome.\n */\n\n[type="number"]::-webkit-inner-spin-button,\n[type="number"]::-webkit-outer-spin-button {\n  height: auto;\n}\n\n/**\n * 1. Correct the odd appearance in Chrome and Safari.\n * 2. Correct the outline style in Safari.\n */\n\n[type="search"] {\n  appearance: textfield;\n  -webkit-appearance: textfield; /* 1 */\n  outline-offset: -2px; /* 2 */\n}\n\n/**\n * Remove the inner padding in Chrome and Safari on macOS.\n */\n\n[type="search"]::-webkit-search-decoration {\n  -webkit-appearance: none;\n}\n\n/**\n * 1. Correct the inability to style clickable types in iOS and Safari.\n * 2. Change font properties to `inherit` in Safari.\n */\n\n::-webkit-file-upload-button {\n  -webkit-appearance: button; /* 1 */\n  font: inherit; /* 2 */\n}\n\n/* Interactive\n   ========================================================================== */\n\n/*\n * Add the correct display in Edge, IE 10+, and Firefox.\n */\n\ndetails {\n  display: block;\n}\n\n/*\n * Add the correct display in all browsers.\n */\n\nsummary {\n  display: list-item;\n}\n\n/* Misc\n   ========================================================================== */\n\n/**\n * Add the correct display in IE 10+.\n */\n\ntemplate {\n  display: none;\n}\n\n/**\n * Add the correct display in IE 10.\n */\n\n[hidden] {\n  display: none;\n}\n',""]);const s=o},402:(e,n,t)=>{t.d(n,{Z:()=>s});var a=t(81),r=t.n(a),i=t(645),o=t.n(i)()(r());o.push([e.id,"html {\n  box-sizing: border-box;\n  scroll-behavior: smooth;\n  font-size: 10px;\n}\n*,\n*::before,\n*::after {\n  box-sizing: border-box;\n}\n\nbody,\nh1,\nh2,\nh3,\nh4,\np,\nul,\nol,\nli,\nfigure,\nfigcaption,\nblockquote,\ndl,\ndd {\nmargin: 0;\n}\n\na {\n  color: inherit;\n  text-decoration: none;\n}\nimg {\n  max-width: 100%;\n}\n\nbody {\n  max-height: 100vh;\n  padding: 20px;\n  font-family: 'Ubuntu Mono', monospace;\n  background: #2e2a23;\n  background-image: gradient(20% 40%,cover circle, #3e392f, #221e17);\n  background-repeat: no-repeat;\n}\n\n.nav {\n  display: flex;\n  margin-bottom: 2rem;\n}\n\n.button {\n  border: 1px solid;\n  margin-right: 20px;\n  font-size: 2rem;\n  padding: 3px 25px;\n  border-radius: 10px;\n  cursor: pointer;\n  transition: all 0.3s ease;\n}\n\n.button:hover {\n  border: 1px solid rgb(108, 119, 159);\n  background-color: rgb(248, 226, 226);;\n}\n\n.button:active {\n  border: 1px solid rgb(81, 97, 156);\n  background-color: rgb(220, 120, 120);;\n}\n\n.menu {\n  display: flex;\n  flex-direction: column;\n  margin-bottom: 3rem;\n}\n\n.create_car, .update_car {\n  margin-bottom: 2rem;\n}\n\n.create_car input, .update_car input  {\n  font-size:  2rem;\n  margin-right: 1rem;\n}\n\n.page__title_garage, .page__title_winners {\n  font-size: 3rem;\n  color: rgb(248, 226, 226);\n}\n\n.track-container {\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n}\n\n.track {\n  margin-top: 20px;\n  border-bottom: 3px solid white;\n  border-top: 3px solid white;\n}\n\n.track_layout {\n  display: flex;\n  justify-content: space-between;\n  align-items: flex-end;\n  border-top: 2px dashed black;\n}\n\n.controls-container {\n  display: flex;\n  align-items: center;\n  gap: 15px;\n}\n\n.car_manipulation,\n.engine_control {\n  display: flex;\n  flex-direction: row;\n  width: 80px;\n  gap: 5px;\n  margin: 5px 0px;\n}\n\n.finish {\n  height: 100px;\n  width: auto;\n}\n\n.car_name {\n  color: azure;\n  font-size: 2rem;\n}\n\n.table {\n  color: white;\n  background-color: black;\n  border: none;\n  margin-top: 20px;\n  width: 100%;\n  font-size: 16px;\n  text-align: center;\n  white-space: wrap;\n  border-spacing: 0px;\n  border-radius: 3px;\n}\n\n.td {\n  background-color: #2e2a23;\n  padding: 5px;\n}\n\n.th {\n  background-color: black;\n  padding: 5px;\n  border-radius: 3px;\n}\n\n.wins:hover,\n.best-time:hover {\n  cursor: pointer;\n  color: red;\n  user-select: none;\n}\n\n.wins:active,\n.best-time:active {\n  transform: scale(95%);\n}\n\n.hidden {\n  display: none;\n}\n\n.visible {\n  display: block;\n}",""]);const s=o},645:e=>{e.exports=function(e){var n=[];return n.toString=function(){return this.map((function(n){var t="",a=void 0!==n[5];return n[4]&&(t+="@supports (".concat(n[4],") {")),n[2]&&(t+="@media ".concat(n[2]," {")),a&&(t+="@layer".concat(n[5].length>0?" ".concat(n[5]):""," {")),t+=e(n),a&&(t+="}"),n[2]&&(t+="}"),n[4]&&(t+="}"),t})).join("")},n.i=function(e,t,a,r,i){"string"==typeof e&&(e=[[null,e,void 0]]);var o={};if(a)for(var s=0;s<this.length;s++){var c=this[s][0];null!=c&&(o[c]=!0)}for(var d=0;d<e.length;d++){var l=[].concat(e[d]);a&&o[l[0]]||(void 0!==i&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=i),t&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=t):l[2]=t),r&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=r):l[4]="".concat(r)),n.push(l))}},n}},81:e=>{e.exports=function(e){return e[1]}},301:(e,n,t)=>{t.r(n),t.d(n,{default:()=>f});var a=t(379),r=t.n(a),i=t(795),o=t.n(i),s=t(569),c=t.n(s),d=t(565),l=t.n(d),u=t(216),m=t.n(u),p=t(589),h=t.n(p),g=t(837),b={};b.styleTagTransform=h(),b.setAttributes=l(),b.insert=c().bind(null,"head"),b.domAPI=o(),b.insertStyleElement=m(),r()(g.Z,b);const f=g.Z&&g.Z.locals?g.Z.locals:void 0},962:(e,n,t)=>{t.r(n),t.d(n,{default:()=>f});var a=t(379),r=t.n(a),i=t(795),o=t.n(i),s=t(569),c=t.n(s),d=t(565),l=t.n(d),u=t(216),m=t.n(u),p=t(589),h=t.n(p),g=t(402),b={};b.styleTagTransform=h(),b.setAttributes=l(),b.insert=c().bind(null,"head"),b.domAPI=o(),b.insertStyleElement=m(),r()(g.Z,b);const f=g.Z&&g.Z.locals?g.Z.locals:void 0},379:e=>{var n=[];function t(e){for(var t=-1,a=0;a<n.length;a++)if(n[a].identifier===e){t=a;break}return t}function a(e,a){for(var i={},o=[],s=0;s<e.length;s++){var c=e[s],d=a.base?c[0]+a.base:c[0],l=i[d]||0,u="".concat(d," ").concat(l);i[d]=l+1;var m=t(u),p={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==m)n[m].references++,n[m].updater(p);else{var h=r(p,a);a.byIndex=s,n.splice(s,0,{identifier:u,updater:h,references:1})}o.push(u)}return o}function r(e,n){var t=n.domAPI(n);return t.update(e),function(n){if(n){if(n.css===e.css&&n.media===e.media&&n.sourceMap===e.sourceMap&&n.supports===e.supports&&n.layer===e.layer)return;t.update(e=n)}else t.remove()}}e.exports=function(e,r){var i=a(e=e||[],r=r||{});return function(e){e=e||[];for(var o=0;o<i.length;o++){var s=t(i[o]);n[s].references--}for(var c=a(e,r),d=0;d<i.length;d++){var l=t(i[d]);0===n[l].references&&(n[l].updater(),n.splice(l,1))}i=c}}},569:e=>{var n={};e.exports=function(e,t){var a=function(e){if(void 0===n[e]){var t=document.querySelector(e);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(e){t=null}n[e]=t}return n[e]}(e);if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(t)}},216:e=>{e.exports=function(e){var n=document.createElement("style");return e.setAttributes(n,e.attributes),e.insert(n,e.options),n}},565:(e,n,t)=>{e.exports=function(e){var n=t.nc;n&&e.setAttribute("nonce",n)}},795:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var n=e.insertStyleElement(e);return{update:function(t){!function(e,n,t){var a="";t.supports&&(a+="@supports (".concat(t.supports,") {")),t.media&&(a+="@media ".concat(t.media," {"));var r=void 0!==t.layer;r&&(a+="@layer".concat(t.layer.length>0?" ".concat(t.layer):""," {")),a+=t.css,r&&(a+="}"),t.media&&(a+="}"),t.supports&&(a+="}");var i=t.sourceMap;i&&"undefined"!=typeof btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),n.styleTagTransform(a,e,n.options)}(n,e,t)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)}}}},589:e=>{e.exports=function(e,n){if(n.styleSheet)n.styleSheet.cssText=e;else{for(;n.firstChild;)n.removeChild(n.firstChild);n.appendChild(document.createTextNode(e))}}},847:(e,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.deleteWinnerApi=n.saveWinnerApi=n.driveApi=n.controlEngineApi=n.deleteCarApi=n.updateCarApi=n.createCarApi=n.getWinners=n.getCar=n.getCars=void 0;const t="http://localhost:3000",a=`${t}/garage`,r=`${t}/winners`,i=`${t}/engine`;n.getCars=async()=>{const e=await fetch(`${a}`),n=await e.json();return{items:await Promise.all(n)}},n.getCar=async e=>(await fetch(`${a}/${e}`)).json(),n.getWinners=async()=>{const e=await fetch(`${r}`),t=await e.json();return{items:await Promise.all(t.map((async e=>({...e,car:await(0,n.getCar)(e.id)})))),count:e.headers.get("X-Total-Count")}},n.createCarApi=async e=>{const n=await fetch(`${a}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return await n.json()},n.updateCarApi=async(e,n)=>(await fetch(`${a}/${e}`,{method:"PUT",body:JSON.stringify(n),headers:{"Content-Type":"application/json"}})).json(),n.deleteCarApi=async e=>(await fetch(`${a}/${e}`,{method:"DELETE"})).json(),n.controlEngineApi=async(e,n)=>(await fetch(`${i}?id=${e}&status=${n}`,{method:"PATCH"})).json(),n.driveApi=async e=>{const n=await fetch(`${i}?id=${e}&status=drive`,{method:"PATCH"}).catch();return 200!==n.status?{success:!1}:{...await n.json()}},n.saveWinnerApi=async(e,n)=>{if(404===(await fetch(`${r}/${e}`)).status)await(async e=>(await fetch(r,{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}})).json())({id:e,wins:1,time:n});else{const t=(await fetch(`${r}/${e}`)).json();await(async e=>(await fetch(`${r}/${e.id}`,{method:"PUT",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}})).json())({id:e,wins:t.wins+1,time:n<t.time?n:t.time})}},n.deleteWinnerApi=async e=>(await fetch(`${r}/${e}`,{method:"DELETE"})).json()},77:(e,n,t)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.App=void 0;const a=t(290),r=t(263),i=t(785),o=t(401);n.App=class{constructor(){this.emitter=new o.EventEmitter,this.navigation=new r.Navigation(this.emitter),this.garage=new a.Garage(this.emitter),this.winners=new i.Winners(this.emitter),this.body=document.querySelector("body")}async start(){this.body?.append(this.navigation.draw(),this.garage.draw(),await this.winners.draw())}}},629:(e,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.createBtn=void 0,n.createBtn=function(e,n,t="button",a){const r=document.createElement("button");return r.classList.add(t),r.id=e,r.innerText=n,a&&r.addEventListener("click",a),r}},401:(e,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.EventEmitter=void 0,n.EventEmitter=class{constructor(){this.events={}}subscribe(e,n){this.events[e]||(this.events[e]=[]),this.events[e].push(n)}emit(e,n){const t=this.events[e];t&&t.forEach((e=>{e.call(null,n)}))}}},263:(e,n,t)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.Navigation=void 0;const a=t(629);n.Navigation=class{constructor(e){this.emitter=e}draw(){const e=this.create(),n=(0,a.createBtn)("nav_garage","Garage");n.addEventListener("click",(()=>{this.emitter.emit("event:to-garage")}));const t=(0,a.createBtn)("nav_winners","Winners");return t.addEventListener("click",(()=>{this.emitter.emit("event:to-winners")})),e.append(n,t),e}create(){const e=document.createElement("nav");return e.classList.add("nav"),e}}},964:(e,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.carModel=n.carName=void 0,n.carName=["Aston Martin","Audi","Bentley","BMW","Bugatti","Chevrolet","Chrysler","Citroen","Continental","Dacia","Datsun","Detroit Electric","Dodge","Ferrari","Fiat","Ford","Geely","Great Wall","Honda","Hummer","Hyundai","Jeep","Lamborghini","Land Rover","Lexus","Mazda","Mercedes-Benz","Range Rover","Renault","SEAT","Subaru","Suzuki","Tesla"],n.carModel=["Durango","Ram","Challenger","Charger","Grand Caravan","Duster","CR-V","Corolla","Rapid","Hatchback","Sedan","Phantom","Camry","Polo","Ghost","Dawn","Duster","Logan","Logan MCV","RAV4","Rio","Solaris"]},311:(e,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.createCarSVG=void 0,n.createCarSVG=function(e,n){const t="http://www.w3.org/2000/svg",a=e.id%4,{width:r,height:i}=n,o=document.createElementNS(t,"svg");o.id=`car-${e.id}`,o.style.fill=`${e.color}`,o.style.width=r,o.style.height=i,o.style.zIndex="5";const s=document.createElementNS(t,"use");return s.setAttributeNS("http://www.w3.org/1999/xlink","href",`./assets/sprite.svg#car-${a}`),o.append(s),o}},329:(e,n,t)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.generateCars=void 0;const a=t(964),r=t(847);function i(){const e="01234567890ABCDEF".split(""),n=e.sort((()=>Math.random()-.5)).slice(0,2),t=e.sort((()=>Math.random()-.5)).slice(0,2),a=e.sort((()=>Math.random()-.5)).slice(0,2);return`#${n.join("")+t.join("")+a.join("")}`}n.generateCars=async function(){const e=[];for(let n=0;n<100;n+=1)e.push((0,r.createCarApi)({name:`${a.carName[Math.round(Math.random()*a.carName.length)]} ${a.carModel[Math.round(Math.random()*a.carModel.length)]}`,color:i()}));return Promise.all(e)}},728:(e,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.Animation=void 0,n.Animation=class{constructor(){this.stoppedAnimations=new Map,this.requestId=new Map}animate(e,n){const t=document.getElementById(`car-${e}`),a=document.getElementById(`finish-${e}`),r=t.getBoundingClientRect().x+t.getBoundingClientRect().width/2,i=a.getBoundingClientRect().x+a.getBoundingClientRect().width/2-50-r,o=n.distance/n.velocity;let s,c,d=!1;const l=n=>{if(s=s||n,c!==n){const e=i/o*(n-s);t.style.transform=`translateX(${e}px)`,e===i&&(d=!0)}if(n-s<o&&(c=n,!d)){if(!Number.isFinite(o))return window.cancelAnimationFrame(this.requestId.get(e)),void this.requestId.set(e,0);this.requestId.set(e,window.requestAnimationFrame(l))}};this.requestId.set(e,window.requestAnimationFrame(l))}}},290:(e,n,t)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.Garage=void 0;const a=t(629),r=t(311),i=t(847),o=t(728),s=t(329);n.Garage=class{constructor(e){this.emitter=e,this.rootElem=this.createElement("section",["garage"],"garage"),this.Animation=new o.Animation,this.emitter.subscribe("event:to-garage",(()=>{this.goToGaragePage()})),this.emitter.subscribe("event:to-winners",(()=>{this.goOutOfGaragePage()}))}draw(){const e=this.rootElem,n=this.generateMenu(),t=this.createPageTitle(),a=this.createElement("div",["track__container"],"track_container");return this.generateTracks(a),e.append(n,t,a),e}async generateTracks(e){(await(0,i.getCars)()).items.forEach((n=>{e.append(this.generateTrack(n))}))}generateMenu(){const e=this.createElement("div",["menu"]),n=this.createElement("div",["create_car"]),t=this.createElement("input",["create_text"],"create_text","text"),r=this.createElement("input",["create_color"],"create_color","color","#FFF"),i=this.createElement("button",["create_btn","button"],"create_btn");i.innerText="CREATE",i.addEventListener("click",(()=>{this.setCreateCarListener()})),n.append(t,r,i);const o=this.createElement("div",["update_car"]),s=this.createElement("input",["update_text"],"update_text","text"),c=this.createElement("input",["update_color"],"update_color","color","#FFF"),d=this.createElement("button",["update_btn","button"],"update_btn");d.innerText="UPDATE",d.addEventListener("click",(()=>{this.updateCarListener(),console.log("update")})),o.append(s,c,d);const l=this.createElement("div",["race_control"]),u=this.createElement("button",["race","button"],"race");u.innerText="RACE",u.addEventListener("click",(e=>{this.race(e)}));const m=this.createElement("button",["generate-cars","button"],"generate-cars");return m.innerText="GENERATE CARS",m.addEventListener("click",(()=>{this.generate100Cars()})),l.append(u,(0,a.createBtn)("reset","RESET"),m),e.append(n,o,l),e}createPageTitle(e=1){let n=document.getElementById("page__title_garage");return n||(n=document.createElement("h2"),n.classList.add("page__title_garage"),n.id="page__title_garage"),n.innerText=`Garage [page ${e}]`,n}createElement(e,n,t,a,r){const i=document.createElement(e);return i.classList.add(...n),t&&(i.id=t),a&&(i.type=a),r&&(i.value=r),i}generateTrack(e){const n=this.createElement("div",["track"]),t=this.createElement("div",["controls_container"]),a=this.createElement("div",["car_manipulation"]);a.append(...this.generateCarManipulations(e));const i=this.createElement("div",["engine_control"]),o=this.createElement("button",["button","start"],"start");o.value=e.id.toString(),o.innerText="Start",o.addEventListener("click",(e=>{this.drive(e.target)}));const s=this.createElement("button",["button","stop"]);s.value=e.id.toString(),s.innerText="Stop",s.addEventListener("click",(e=>{this.drive(e.target)})),i.append(o,s);const c=this.createElement("p",["car_name"]);c.innerText=e.name,t.append(a,i,c);const d=this.createElement("div",["track_layout"]),l=(0,r.createCarSVG)(e,{width:"150px",height:"60px"}),u=this.createFinish(e);return d.append(l,u),n.append(t,d),n}generateCarManipulations(e){const n=this.createElement("button",["button","select"]);n.value=e.id.toString(),n.innerText="Select",n.addEventListener("click",(e=>{const n=e.target.value;this.selectListener(+n)}));const t=this.createElement("button",["button","remove"]);return t.value=e.id.toString(),t.innerText="Remove",t.addEventListener("click",(e=>{const n=e.target.value;this.removeListener(+n)})),[n,t]}createFinish(e){const n=document.createElement("img");return n.classList.add("finish"),n.src="./assets/finish.jpg",n.id=`finish-${e.id}`,n}async setCreateCarListener(){const e=document.querySelector("#create_text"),n=document.querySelector("#create_color"),t=document.getElementById("track_container");if(e&&n){if(""===e.value)return;await(0,i.createCarApi)({name:e.value,color:n.value}),t.innerHTML="",this.generateTracks(t)}}async selectListener(e){const n=await(0,i.getCar)(e),t=document.getElementById("update_text"),a=document.getElementById("update_color"),r=document.getElementById("update_btn");t.value=n.name,a.value=n.color,r.value=`${e}`,window.scrollTo(0,0)}async updateCarListener(){const e=document.getElementById("update_text"),n=document.getElementById("update_color"),t=document.getElementById("update_btn"),a=document.getElementById("track_container");await(0,i.updateCarApi)(Number(t.value),{name:e?.value,color:n?.value}),e.value="",n.value="#FFFFFF",t.value="",a.innerHTML="",this.generateTracks(a)}async removeListener(e){const n=document.getElementById("track_container");await(0,i.deleteCarApi)(e),await(0,i.deleteWinnerApi)(e),n.innerHTML="",await this.generateTracks(n),this.emitter.emit("event:update-winners")}async drive(e){const n=+e.value;let t,a;e.classList.contains("start")?(a="started",e.classList.toggle("disabled"),e.nextElementSibling?.classList.toggle("disabled")):(a="stopped",e.classList.toggle("disabled"),e.previousElementSibling?.classList.toggle("disabled"));const r=await(0,i.controlEngineApi)(n,a),o=Math.round(r.distance/r.velocity)/1e3;if("started"===a){this.Animation.animate(n,r),this.Animation.stoppedAnimations.delete(n);const{success:e}=await(0,i.driveApi)(n);e||this.Animation.stoppedAnimations.has(n)||window.cancelAnimationFrame(this.Animation.requestId.get(n)),e&&(t=e)}else this.Animation.animate(n,r),this.Animation.stoppedAnimations.set(n,n);return{successStatus:t,carId:n,time:o}}async race(e){const n=document.getElementById("track_container"),t=e.target;n.innerHTML="",await this.generateTracks(n);const a=document.querySelectorAll(".start"),r=Array.from(a).map((async e=>this.drive(e)));Promise.any(r).then((async e=>{t.nextElementSibling?.classList.toggle("disabled");const{carId:n,time:a}=e;await(0,i.saveWinnerApi)(n,a),this.emitter.emit("event:update-winners")}))}async generate100Cars(){const e=document.getElementById("track_container");await(0,s.generateCars)(),e.innerHTML="",await this.generateTracks(e)}goToGaragePage(){this.rootElem.classList.remove("hidden"),this.rootElem.classList.add("visible")}goOutOfGaragePage(){this.rootElem.classList.remove("visible"),this.rootElem.classList.add("hidden")}}},785:(e,n,t)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.Winners=void 0;const a=t(311),r=t(847);n.Winners=class{constructor(e){this.emitter=e,this.rootElem=this.createElement("div",["winners"]),this.emitter.subscribe("event:to-garage",(()=>{this.goOutOfWinnersPage()})),this.emitter.subscribe("event:to-winners",(()=>{this.goToWinnersPage()})),this.emitter.subscribe("event:update-winners",(()=>{this.updateWinners()}))}async draw(){const e=this.rootElem;e.classList.add("hidden");const n=this.createPageTitle();e.append(n);const t=await this.generateTable();return e.append(t),e}createPageTitle(e=1){let n=document.getElementById("page__title_winners");return n||(n=document.createElement("h2"),n.classList.add("page__title_winners"),n.id="page__title_winners"),n.innerText=`Winners [page ${e}]`,n}createElement(e,n,t,a,r){const i=document.createElement(e);return i.classList.add(...n),t&&(i.id=t),a&&(i.type=a),r&&(i.value=r),i}async generateTable(){const e=await(0,r.getWinners)(),n=this.createTable(),t=this.createElement("tbody",["t_body"]),a=this.createTableHead();return n.append(t),t.appendChild(a),e.items.forEach(((e,n)=>t.append(this.generateTableRow(e,n+1)))),n}createTable(){let e=document.getElementById("table");return e?(e.remove(),e=document.createElement("table")):e=document.createElement("table"),e.classList.add("table"),e.id="table",e}createTableHead(){const e=this.createTH("Number"),n=this.createTH("Car"),t=this.createTH("Name"),a=this.createTH("Wins","wins"),r=this.createTH("Best time (s)","best-time"),i=this.createTR("table-head");return i.append(e,n,t,a,r),i}createTH(e,n){const t=document.createElement("th");return t.classList.add("th"),void 0!==n&&(t.classList.add(n),t.id=n),t.innerHTML=e,t}createTR(e){const n=document.createElement("tr");return n.classList.add("tr"),n.id=e,n}generateTableRow(e,n){console.log(e);const t=this.createTD(`${n}`),r=(0,a.createCarSVG)(e.car,{width:"50px",height:"30px"}),i=this.createTD("");i.append(r);const o=this.createTD(`${e.car.name}`),s=this.createTD(`${e.wins}`),c=this.createTD(`${e.time}`),d=this.createTR(`table-row-${e.id}`);return d.append(t,i,o,s,c),d}createTD(e){const n=document.createElement("td");return n.classList.add("td"),n.innerText=e,n}async updateWinners(){const e=await(0,r.getWinners)(),n=document.getElementById("table");n.innerHTML="";const t=this.createElement("tbody",["t_body"]),a=this.createTableHead();return n.append(t),t.appendChild(a),e.items.forEach(((e,n)=>t.append(this.generateTableRow(e,n+1)))),n}goToWinnersPage(){this.rootElem.classList.remove("hidden"),this.rootElem.classList.add("visible")}goOutOfWinnersPage(){this.rootElem.classList.remove("visible"),this.rootElem.classList.add("hidden")}}}},n={};function t(a){var r=n[a];if(void 0!==r)return r.exports;var i=n[a]={id:a,exports:{}};return e[a](i,i.exports,t),i.exports}t.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return t.d(n,{a:n}),n},t.d=(e,n)=>{for(var a in n)t.o(n,a)&&!t.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:n[a]})},t.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),t.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.nc=void 0,(()=>{t(301),t(962);const e=t(77);window.onload=()=>{(new e.App).start()}})()})();